{% extends 'base.html' %}

{% block head %}
<body>

    <!-- Back to Explore and Profile Management buttons -->
    <a href="{% url 'explore' %}" class="btn btn-primary">Back to Explore |</a>
    <a href="{% url 'profile_management' %}" class="btn btn-primary">Profile Management</a>

    <!-- Display Username at the top left -->
    <div class="user-info">
        <h2>Welcome, {{ request.user.username }}!</h2>
    </div>

    <!-- Display the User's Introduction -->
    <div class="intro-box">
        <h3>About {{ request.user.username }}</h3>
        {% if request.user.profile.introduction %}
            <p>{{ request.user.profile.introduction }}</p>
        {% else %}
            <p>No introduction provided yet. Please update your profile to add one!</p>
        {% endif %}
    </div>

    <h1>Profile</h1>

    <h2>Your Listings</h2>
    {% if listings %}
        <ul>
        {% for listing in listings %}
            <li>
                <p><strong>{{ listing.name }}</strong> - ${{ listing.price }}</p>
                <p>{{ listing.description }}</p>
                <img src="{{ listing.image.url }}" width="200" height="200" alt="Listing Image">

                <!-- Only show edit and delete buttons if the listing belongs to the logged-in user -->
                {% if request.user == listing.user %}
                    <!-- Link to edit listing page -->
                    <a href="{% url 'edit_listing' listing.id %}">
                        <button type="button">Edit</button>
                    </a>

                    <!-- Form to delete listing -->
                    <form action="{% url 'delete_listing' listing.id %}" method="POST" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit">Delete</button>
                    </form>
                {% endif %}
            </li>
        {% endfor %}
        </ul>
    {% else %}
        <p>You have no listings yet.</p>
    {% endif %}
</body>
{% endblock %}
